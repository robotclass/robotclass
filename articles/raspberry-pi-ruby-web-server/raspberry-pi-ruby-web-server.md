Запускт веб-сервера на базе RaspberryPi (Ruby/Sinatra)
======================================================


У вас есть RaspberryPi микрокомпьютер и хотите сделать простую веб-админку,
то для этого можно использовать Ruby язык, и простой веб-фреймворк на базе Sinatra.

Весь процесс от начала, и до открытия веб-страницы в браузере займёт не более 10 минут,
при знание Ruby на данном этапе - не обязательное.

Предполагается, что вы проделали процедуру настройки RPi (например на базе данного туториала
https://github.com/robotclass/robotclass/blob/master/articles/raspberry-pi-start/raspberry-pi-start.md)

Начальное состояние
-------------------

RPi подключен к интернету, вы зашли в него по SSH.


Установка Ruby
--------------

Можно установить из пакетов:

    sudo apt-get install ruby

Будет установлен `Ruby` 1.9.3 версии, и менеджер пакетов `Gem`.


Установка фреймворка Sinatra
----------------------------

Многие наверное слышали про веб-фреймвор на базе Ruby - RubyOnRails, 
для наших несложных задач можно попробовать простой и элегантный фреймворк Sinatra.

Устанавливаем его с помощью менеджера пакетов `Gem`:

    sudo gem install sinatra


Запуск веб-сервера
------------------

Мы не будем устанавливать Apache или Nginx - для тестовых задач вполне подойдёт
поставляемый вместе с Ruby веб-сервер WEBRick.

Нам необходимо только написать программу для обработки входящих запросов по HTTP,
и выдачу результатов браузеру.

Создаём папку `web` в ней будет наше приложение:

    makedir web

Переходим в папку:

    cd web

Создаём и открываем на редактирование файл `app.rb`:

    nano app.rb

Открывается текстовый редактор, вводим этот код:


    require 'sinatra'

    get '/' do
      'Hello world!'
    end

Сохраняем - нажимая "F2", подтверждаем сохранение нажав "Y", 
видим название файла - нажимаем Enter.


Наша программа содержит один обработчик на входящий GET запрос "/", и выдачу
текста `'Hello world!'` в ответ.

Для старта надо набрать:

    ruby app.rb -o IP.IP.IP.IP

Где IP.IP.IP.IP - это IP адрес вашего микрокомпьютера RaspberryPi.


В случае успешного запуска будет выведено что-то вроде этого:


    [2013-07-19 06:04:22] INFO  WEBrick 1.3.1
    [2013-07-19 06:04:22] INFO  ruby 1.9.3 (2012-04-20) [arm-linux-eabihf]
    == Sinatra/1.4.3 has taken the stage on 4567 for development with backup from WEBrick
    [2013-07-19 06:04:22] INFO  WEBrick::HTTPServer#start: pid=2794 port=4567

Что означает, что веб-сервер `WEBrick` успешно стартовал и слушает порт `4567`, по умолчанию.


Открываем браузером адрес:

   http://IP.IP.IP.IP:4567

Видим: `Hello world!`


